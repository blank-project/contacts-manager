{{#with contact}}
<dl>
  <dt>Nom</dt><dd>{{ fullName }}</dd>
  <dt>Mail</dt><dd>{{ email }}</dd>
  <dt>Téléphone</dt><dd>{{ phone }}</dd>
  <dt>Organisation</dt><dd>{{ organization }}</dd>
  <dt>Fonction</dt><dd>{{ title }}</dd>
  {{#with address }}
  <dt>Adresse</dt><dd>
    <address>
     <span>{{ number }}</span> <span>{{ street }}</span><br />
     <span>{{ code }}</span> <span>{{ city }}</span><br />
   </address>
  </dd>
  {{/with}}
  <dt>Etiquettes</dt><dd>
    <div>
      {{#each tags}}
        {{! TODO Find a way to factor tag and tagEdit}}
        {{>tagEdit}}
      {{else}}
        Aucune étiquette
      {{/each}}
    </div>
    <form method="POST" action="/contacts/{{ id }}/tags/">
      <select name="tagId" id="tagId">
        {{#each ../tags}}
        <option value="{{ id }}">{{ name }}</option>
        {{/each}}
      </select>
      <input type="submit" value="Ajouter" />
    </form>
  </dd>
  <dt>Note</dt><dd>{{ note }}</dd>
</dl>
{{/with}}
{{#with contact}}
<a href="edit/{{ id }}">Modifier</a>
<button id="delete">Supprimer</button>
{{/with}}
<div>
<a href="/contacts/">Retour à la liste</a>
</div>

<script>
    var removeTag = function(id) {
      axios.delete("/contacts/{{ contact.id }}/tags/" + id)
      .then(function (response) {
        location.reload(true);
      })
      .catch(console.log);
    }, els = document.getElementsByClassName("tag-remove"), el;

    for (var i = 0; i < els.length; i++) {
      el = els[i];
      var tagId = el.getAttribute("data-id");
      el.addEventListener('click', function(ev) {
        removeTag(tagId);
      });
    }
</script>
<script>
    var remove = function(id) {
      axios.delete("/contacts/" + id)
      .then(function (response) {
        location.assign("/contacts/");
      })
      .catch(console.log);
    }, deleteButton = document.getElementById("delete");

    deleteButton.addEventListener('click', function(ev) {
      remove('{{ contact.id }}');
    });
</script>
